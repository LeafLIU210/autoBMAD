Please fix the Python code in the following file: d:\GITHUB\pytQt_template\autoBMAD\epic_automation\test_automation_agent.py

BasedPyright type errors (28):  Line 36, Col 18: [reportUnusedImport] "_query" 导入项未使用 (reportUnusedImport)
  Line 37, Col 31: [reportUnusedImport] "_ClaudeAgentOptions" 导入项未使用 (reportUnusedImport)
  Line 38, Col 26: [reportUnusedImport] "_ResultMessage" 导入项未使用 (reportUnusedImport)
  Line 62, Col 10: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 93, Col 38: [reportIndexIssue] 在 "list" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 93, Col 43: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 94, Col 53: [unknown] 部分参数的类型未知
  Line 105, Col 105: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 109, Col 13: [reportUnusedVariable] 变量 "stdout" 未使用 (reportUnusedVariable)
  Line 109, Col 21: [reportUnusedVariable] 变量 "stderr" 未使用 (reportUnusedVariable)
  Line 127, Col 64: [reportIndexIssue] 在 "list" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 127, Col 69: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 151, Col 41: [reportIndexIssue] 在 "list" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 151, Col 46: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 194, Col 20: [reportUnnecessaryComparison] 条件的计算结果始终为 `True`，因为类型 "type[ResultMessage]" 和 "None" 之间不存在交集 (reportUnnecessaryComparison)
  Line 194, Col 51: [reportUnnecessaryIsInstance] "type[ResultMessage]" 一定是 "type" 的实例，无需再调用 `isinstance` (reportUnnecessaryIsInstance)
  Line 226, Col 51: [reportIndexIssue] 在 "list" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 226, Col 56: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 262, Col 67: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 262, Col 86: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 277, Col 20: [reportUnusedImport] "debugpy" 导入项未使用 (reportUnusedImport)
  Line 314, Col 10: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 379, Col 65: [unknown] 部分参数的类型未知
  Line 381, Col 47: [unknown] 参数类型未知
  Line 381, Col 72: [unknown] 参数类型未知
  Line 421, Col 45: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 421, Col 71: [reportIndexIssue] 在 "list" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 421, Col 76: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)

Requirements:
1. Fix all the errors listed above
2. Maintain code functionality and readability
3. Follow Python best practices
4. Preserve existing code style where possible
5. Add comments explaining complex fixes if necessary

Please provide the complete fixed file content.
