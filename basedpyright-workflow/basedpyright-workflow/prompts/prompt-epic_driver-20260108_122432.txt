Please fix the Python code in the following file: d:\GITHUB\pytQt_template\autoBMAD\epic_automation\epic_driver.py

BasedPyright type errors (76):  Line 77, Col 12: [unknown] "str" 与 "bool | float | dict[str, str | dict[str, str | None]] | list[Unknown] | None" 类型不支持 "in" 运算符
  Line 78, Col 13: [reportIndexIssue] "bool" 类型上未定义 "__getitem__" 方法 (reportIndexIssue)
  Line 78, Col 13: [reportOptionalSubscript] `None` 不支持下标访问 (reportOptionalSubscript)
  Line 78, Col 13: [reportIndexIssue] "float" 类型上未定义 "__getitem__" 方法 (reportIndexIssue)
  Line 78, Col 13: [reportCallIssue] "__getitem__" 的重载与提供的参数不匹配 (reportCallIssue)
  Line 78, Col 13: [unknown] "str" 类型的实参无法赋值给函数 "__getitem__" 中 "slice[Any, Any, Any]" 类型的形参 "s"
  Line 78, Col 13: [reportIndexIssue] "str" 类型上未定义 "__setitem__" 方法 (reportIndexIssue)
  Line 80, Col 17: [reportIndexIssue] "bool" 类型上未定义 "__getitem__" 方法 (reportIndexIssue)
  Line 80, Col 17: [reportOptionalSubscript] `None` 不支持下标访问 (reportOptionalSubscript)
  Line 80, Col 17: [reportIndexIssue] "float" 类型上未定义 "__getitem__" 方法 (reportIndexIssue)
  Line 80, Col 17: [reportCallIssue] "__getitem__" 的重载与提供的参数不匹配 (reportCallIssue)
  Line 80, Col 17: [unknown] "str" 类型的实参无法赋值给函数 "__getitem__" 中 "slice[Any, Any, Any]" 类型的形参 "s"
  Line 80, Col 17: [reportIndexIssue] "str" 类型上未定义 "__setitem__" 方法 (reportIndexIssue)
  Line 80, Col 17: [unknown] "float" 类型的实参无法赋值给函数 "__setitem__" 中 "str | None" 类型的形参 "value"
  Line 82, Col 17: [reportIndexIssue] "bool" 类型上未定义 "__getitem__" 方法 (reportIndexIssue)
  Line 82, Col 17: [reportOptionalSubscript] `None` 不支持下标访问 (reportOptionalSubscript)
  Line 82, Col 17: [reportIndexIssue] "float" 类型上未定义 "__getitem__" 方法 (reportIndexIssue)
  Line 82, Col 17: [reportCallIssue] "__getitem__" 的重载与提供的参数不匹配 (reportCallIssue)
  Line 82, Col 17: [unknown] "str" 类型的实参无法赋值给函数 "__getitem__" 中 "slice[Any, Any, Any]" 类型的形参 "s"
  Line 82, Col 17: [reportIndexIssue] "str" 类型上未定义 "__setitem__" 方法 (reportIndexIssue)
  Line 82, Col 17: [unknown] "float" 类型的实参无法赋值给函数 "__setitem__" 中 "str | None" 类型的形参 "value"
  Line 96, Col 9: [reportIndexIssue] "bool" 类型上未定义 "__setitem__" 方法 (reportIndexIssue)
  Line 96, Col 9: [reportOptionalSubscript] `None` 不支持下标访问 (reportOptionalSubscript)
  Line 96, Col 9: [reportIndexIssue] "float" 类型上未定义 "__setitem__" 方法 (reportIndexIssue)
  Line 96, Col 9: [reportCallIssue] "__setitem__" 的重载与提供的参数不匹配 (reportCallIssue)
  Line 96, Col 9: [unknown] "Literal['current_phase']" 类型的实参无法赋值给函数 "__setitem__" 中 "slice[Any, Any, Any]" 类型的形参 "key"
  Line 124, Col 40: [unknown] 无法访问 "bool" 类的 "append" 属性
  Line 124, Col 40: [reportOptionalMemberAccess] `None` 没有 "append" 属性 (reportOptionalMemberAccess)
  Line 124, Col 40: [unknown] 无法访问 "float" 类的 "append" 属性
  Line 124, Col 40: [unknown] 无法访问 "dict[str, str | dict[str, str | None]]" 类的 "append" 属性
  Line 135, Col 36: [unknown] 无法访问 "bool" 类的 "append" 属性
  Line 135, Col 36: [reportOptionalMemberAccess] `None` 没有 "append" 属性 (reportOptionalMemberAccess)
  Line 135, Col 36: [unknown] 无法访问 "float" 类的 "append" 属性
  Line 135, Col 36: [unknown] 无法访问 "dict[str, str | dict[str, str | None]]" 类的 "append" 属性
  Line 150, Col 9: [reportIndexIssue] "bool" 类型上未定义 "__setitem__" 方法 (reportIndexIssue)
  Line 150, Col 9: [reportOptionalSubscript] `None` 不支持下标访问 (reportOptionalSubscript)
  Line 150, Col 9: [reportIndexIssue] "float" 类型上未定义 "__setitem__" 方法 (reportIndexIssue)
  Line 150, Col 9: [reportCallIssue] "__setitem__" 的重载与提供的参数不匹配 (reportCallIssue)
  Line 150, Col 9: [unknown] "Literal['current_phase']" 类型的实参无法赋值给函数 "__setitem__" 中 "slice[Any, Any, Any]" 类型的形参 "key"
  Line 178, Col 40: [unknown] 无法访问 "bool" 类的 "append" 属性
  Line 178, Col 40: [reportOptionalMemberAccess] `None` 没有 "append" 属性 (reportOptionalMemberAccess)
  Line 178, Col 40: [unknown] 无法访问 "float" 类的 "append" 属性
  Line 178, Col 40: [unknown] 无法访问 "dict[str, str | dict[str, str | None]]" 类的 "append" 属性
  Line 189, Col 36: [unknown] 无法访问 "bool" 类的 "append" 属性
  Line 189, Col 36: [reportOptionalMemberAccess] `None` 没有 "append" 属性 (reportOptionalMemberAccess)
  Line 189, Col 36: [unknown] 无法访问 "float" 类的 "append" 属性
  Line 189, Col 36: [unknown] 无法访问 "dict[str, str | dict[str, str | None]]" 类的 "append" 属性
  Line 204, Col 9: [reportIndexIssue] "bool" 类型上未定义 "__setitem__" 方法 (reportIndexIssue)
  Line 204, Col 9: [reportOptionalSubscript] `None` 不支持下标访问 (reportOptionalSubscript)
  Line 204, Col 9: [reportIndexIssue] "float" 类型上未定义 "__setitem__" 方法 (reportIndexIssue)
  Line 204, Col 9: [reportCallIssue] "__setitem__" 的重载与提供的参数不匹配 (reportCallIssue)
  Line 204, Col 9: [unknown] "Literal['current_phase']" 类型的实参无法赋值给函数 "__setitem__" 中 "slice[Any, Any, Any]" 类型的形参 "key"
  Line 239, Col 40: [unknown] 无法访问 "bool" 类的 "append" 属性
  Line 239, Col 40: [reportOptionalMemberAccess] `None` 没有 "append" 属性 (reportOptionalMemberAccess)
  Line 239, Col 40: [unknown] 无法访问 "float" 类的 "append" 属性
  Line 239, Col 40: [unknown] 无法访问 "dict[str, str | dict[str, str | None]]" 类的 "append" 属性
  Line 250, Col 36: [unknown] 无法访问 "bool" 类的 "append" 属性
  Line 250, Col 36: [reportOptionalMemberAccess] `None` 没有 "append" 属性 (reportOptionalMemberAccess)
  Line 250, Col 36: [unknown] 无法访问 "float" 类的 "append" 属性
  Line 250, Col 36: [unknown] 无法访问 "dict[str, str | dict[str, str | None]]" 类的 "append" 属性
  Line 269, Col 9: [reportIndexIssue] "bool" 类型上未定义 "__setitem__" 方法 (reportIndexIssue)
  Line 269, Col 9: [reportOptionalSubscript] `None` 不支持下标访问 (reportOptionalSubscript)
  Line 269, Col 9: [reportIndexIssue] "float" 类型上未定义 "__setitem__" 方法 (reportIndexIssue)
  Line 269, Col 9: [reportCallIssue] "__setitem__" 的重载与提供的参数不匹配 (reportCallIssue)
  Line 269, Col 9: [unknown] "Literal['current_phase']" 类型的实参无法赋值给函数 "__setitem__" 中 "slice[Any, Any, Any]" 类型的形参 "key"
  Line 304, Col 36: [unknown] 无法访问 "bool" 类的 "append" 属性
  Line 304, Col 36: [reportOptionalMemberAccess] `None` 没有 "append" 属性 (reportOptionalMemberAccess)
  Line 304, Col 36: [unknown] 无法访问 "float" 类的 "append" 属性
  Line 304, Col 36: [unknown] 无法访问 "dict[str, str | dict[str, str | None]]" 类的 "append" 属性
  Line 312, Col 17: [unknown] "float | dict[str, str | dict[str, str | None]] | list[Unknown] | Literal[True]" 类型的实参无法赋值给函数 "_calculate_duration" 中 "float" 类型的形参 "start_time"
  Line 319, Col 72: [unknown] "float | dict[str, str | dict[str, str | None]] | list[Unknown] | Literal[True]" 类型的实参无法赋值给函数 "len" 中 "Sized" 类型的形参 "obj"
  Line 324, Col 9: [reportIndexIssue] "bool" 类型上未定义 "__setitem__" 方法 (reportIndexIssue)
  Line 324, Col 9: [reportOptionalSubscript] `None` 不支持下标访问 (reportOptionalSubscript)
  Line 324, Col 9: [reportIndexIssue] "float" 类型上未定义 "__setitem__" 方法 (reportIndexIssue)
  Line 324, Col 9: [reportCallIssue] "__setitem__" 的重载与提供的参数不匹配 (reportCallIssue)
  Line 324, Col 9: [unknown] "Literal['current_phase']" 类型的实参无法赋值给函数 "__setitem__" 中 "slice[Any, Any, Any]" 类型的形参 "key"

Requirements:
1. Fix all the errors listed above
2. Maintain code functionality and readability
3. Follow Python best practices
4. Preserve existing code style where possible
5. Add comments explaining complex fixes if necessary

Please provide the complete fixed file content.
