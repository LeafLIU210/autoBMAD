Please fix the Python code in the following file: d:\GITHUB\pytQt_template\autoBMAD\epic_automation\epic_driver.py

BasedPyright type errors (72):  Line 31, Col 14: [reportMissingTypeArgument] "list" 泛型类应有类型参数 (reportMissingTypeArgument)
  Line 42, Col 20: [reportMissingTypeArgument] "dict" 泛型类应有类型参数 (reportMissingTypeArgument)
  Line 142, Col 29: [reportIndexIssue] 在 "list" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 142, Col 34: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 211, Col 25: [reportUnknownVariableType] "story_file" 类型未知 (reportUnknownVariableType)
  Line 212, Col 25: [unknown] "append" 的类型部分未知
  Line 214, Col 41: [reportUnknownMemberType] "resolve" 类型未知 (reportUnknownMemberType)
  Line 214, Col 41: [unknown] 参数类型未知
  Line 215, Col 37: [reportUnknownMemberType] "name" 类型未知 (reportUnknownMemberType)
  Line 217, Col 25: [unknown] "append" 的类型部分未知
  Line 225, Col 29: [unknown] "append" 的类型部分未知
  Line 230, Col 29: [unknown] "append" 的类型部分未知
  Line 242, Col 52: [unknown] 部分参数的类型未知
  Line 247, Col 13: [unknown] "sort" 的类型部分未知
  Line 247, Col 37: [reportUnknownLambdaType] "x" 参数的类型未知 (reportUnknownLambdaType)
  Line 247, Col 40: [reportUnknownLambdaType] 该 `lambda` 的返回类型未知 (reportUnknownLambdaType)
  Line 250, Col 55: [unknown] 部分参数的类型未知
  Line 252, Col 20: [reportUnknownVariableType] 返回类型 "list[Unknown]" 部分未知 (reportUnknownVariableType)
  Line 260, Col 61: [reportIndexIssue] 在 "list" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 281, Col 13: [unknown] "append" 的类型部分未知
  Line 291, Col 17: [unknown] "append" 的类型部分未知
  Line 295, Col 9: [unknown] "seen" 的类型部分未知
  Line 297, Col 13: [reportUnknownVariableType] "story_id" 类型未知 (reportUnknownVariableType)
  Line 299, Col 13: [reportUnknownVariableType] "key" 类型未知 (reportUnknownVariableType)
  Line 299, Col 19: [reportUnknownMemberType] "split" 类型未知 (reportUnknownMemberType)
  Line 299, Col 19: [reportUnknownMemberType] "strip" 类型未知 (reportUnknownMemberType)
  Line 299, Col 19: [reportUnknownMemberType] "zfill" 类型未知 (reportUnknownMemberType)
  Line 301, Col 17: [unknown] "add" 的类型部分未知
  Line 301, Col 26: [unknown] 参数类型未知
  Line 302, Col 17: [unknown] "append" 的类型部分未知
  Line 302, Col 41: [unknown] 参数类型未知
  Line 304, Col 39: [unknown] 部分参数的类型未知
  Line 306, Col 16: [reportUnknownVariableType] 返回类型 "list[Unknown]" 部分未知 (reportUnknownVariableType)
  Line 436, Col 89: [reportGeneralTypeIssues] `Union` 的替代语法需要 Python 3.10 或更高版本 (reportGeneralTypeIssues)
  Line 557, Col 13: [reportUnknownVariableType] "guidance" 类型未知 (reportUnknownVariableType)
  Line 557, Col 24: [unknown] "task_guidance" 的类型部分未知
  Line 557, Col 24: [unknown] "get" 的类型部分未知
  Line 610, Col 13: [reportUnknownVariableType] "guidance" 类型未知 (reportUnknownVariableType)
  Line 610, Col 24: [unknown] "task_guidance" 的类型部分未知
  Line 610, Col 24: [unknown] "get" 的类型部分未知
  Line 656, Col 13: [reportUnknownVariableType] "guidance" 类型未知 (reportUnknownVariableType)
  Line 656, Col 24: [unknown] "task_guidance" 的类型部分未知
  Line 656, Col 24: [unknown] "get" 的类型部分未知
  Line 699, Col 42: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 764, Col 54: [reportIndexIssue] 在 "list" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 764, Col 59: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 799, Col 46: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 815, Col 18: [reportMissingImports] 无法解析导入 "code_quality_agent" (reportMissingImports)
  Line 815, Col 44: [reportUnknownVariableType] "CodeQualityAgent" 类型未知 (reportUnknownVariableType)
  Line 817, Col 13: [reportUnknownVariableType] "quality_agent" 类型未知 (reportUnknownVariableType)
  Line 823, Col 13: [reportUnknownVariableType] "quality_results" 类型未知 (reportUnknownVariableType)
  Line 823, Col 37: [reportUnknownMemberType] "run_quality_gates" 类型未知 (reportUnknownMemberType)
  Line 829, Col 13: [reportUnknownVariableType] "status" 类型未知 (reportUnknownVariableType)
  Line 829, Col 22: [reportUnknownMemberType] "get" 类型未知 (reportUnknownMemberType)
  Line 830, Col 58: [unknown] 参数类型未知
  Line 830, Col 66: [unknown] 参数类型未知
  Line 839, Col 20: [reportUnknownVariableType] 返回类型未知 (reportUnknownVariableType)
  Line 846, Col 48: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 862, Col 18: [reportMissingImports] 无法解析导入 "test_automation_agent" (reportMissingImports)
  Line 862, Col 47: [reportUnknownVariableType] "TestAutomationAgent" 类型未知 (reportUnknownVariableType)
  Line 864, Col 13: [reportUnknownVariableType] "test_agent" 类型未知 (reportUnknownVariableType)
  Line 870, Col 13: [reportUnknownVariableType] "test_results" 类型未知 (reportUnknownVariableType)
  Line 870, Col 34: [reportUnknownMemberType] "run_test_automation" 类型未知 (reportUnknownMemberType)
  Line 876, Col 13: [reportUnknownVariableType] "status" 类型未知 (reportUnknownVariableType)
  Line 876, Col 22: [reportUnknownMemberType] "get" 类型未知 (reportUnknownMemberType)
  Line 877, Col 60: [unknown] 参数类型未知
  Line 877, Col 68: [unknown] 参数类型未知
  Line 886, Col 20: [reportUnknownVariableType] 返回类型未知 (reportUnknownVariableType)
  Line 914, Col 72: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 970, Col 41: [reportIndexIssue] 在 "dict" 类上使用的下标将导致运行时异常，应将整个类型表达式写成字符串形式 (reportIndexIssue)
  Line 985, Col 34: [unknown] "stories" 的类型部分未知
  Line 985, Col 34: [unknown] 部分参数的类型未知

Requirements:
1. Fix all the errors listed above
2. Maintain code functionality and readability
3. Follow Python best practices
4. Preserve existing code style where possible
5. Add comments explaining complex fixes if necessary

Please provide the complete fixed file content.
