<!-- Powered by BMADâ„¢ Core -->

# Story 1.4: Command-Line Interface

## Status
**Ready for Review**

## Story
**As a** user,
**I want** a command-line interface to test the bubble sort algorithm,
**so that** I can easily demonstrate and experiment with the implementation.

## Acceptance Criteria
1. Create CLI entry point that accepts arrays as command-line arguments
2. Support reading arrays from files or standard input
3. Provide options for different output formats (sorted array, detailed process)
4. Include help documentation and usage examples
5. Handle command-line errors gracefully with helpful error messages
6. Support both interactive and batch modes of operation

## Tasks / Subtasks
- [x] Setup CLI entry point (AC: 1)
  - [x] Create main CLI module/script
  - [x] Configure entry point in pyproject.toml
  - [x] Accept arrays as command-line arguments
  - [x] Parse comma-separated or space-separated values
- [x] Implement file input support (AC: 2)
  - [x] Add --input-file option
  - [x] Support JSON and plain text formats
  - [x] Read from stdin if no file specified
  - [x] Validate file format and content
- [x] Create output formatting options (AC: 3)
  - [x] Add --format option (sorted, detailed, steps)
  - [x] Implement sorted array output (default)
  - [x] Implement detailed output with comparisons count
  - [x] Implement step-by-step output showing each pass
- [x] Add help and documentation (AC: 4)
  - [x] Implement --help flag
  - [x] Add usage examples in help text
  - [x] Document all command-line options
  - [x] Include algorithm information
- [x] Implement error handling (AC: 5)
  - [x] Catch and display parsing errors
  - [x] Provide helpful error messages
  - [x] Handle file I/O errors gracefully
  - [x] Validate numeric inputs
- [x] Support multiple modes (AC: 6)
  - [x] Implement interactive mode
  - [x] Implement batch mode
  - [x] Add --interactive flag
  - [x] Allow multiple arrays in batch mode

## Dev Notes

### Relevant Source Tree
- CLI implementation: `src/cli.py` or `src/__main__.py`
- Main implementation: `src/` (from Story 1.2)
- Entry point configuration: `pyproject.toml`
- Test files: `tests/test_cli.py` (new file)

### CLI Requirements
The CLI should support the following usage patterns:

**Basic Usage:**
```bash
python -m bubble_sort 5 3 1 4 2
# Output: [1, 2, 3, 4, 5]
```

**File Input:**
```bash
python -m bubble_sort --input-file data.txt
python -m bubble_sort < data.txt
```

**Output Formats:**
- `--format sorted` (default): Show only sorted array
- `--format detailed`: Show sorted array with comparison count
- `--format steps`: Show each pass of the algorithm

**Interactive Mode:**
```bash
python -m bubble_sort --interactive
# Then enter numbers one per line or comma-separated
```

### Implementation Details
- Use `argparse` or `click` for command-line argument parsing
- Create a main() function that serves as entry point
- Configure entry point in pyproject.toml:
  ```toml
  [project.scripts]
  bubble-sort = "src.cli:main"
  ```
- Ensure the CLI works both as a module and as an installed command

### Input Parsing
- Accept space-separated numbers: `5 3 1 4 2`
- Accept comma-separated numbers: `5,3,1,4,2`
- Support reading from files with one number per line or comma-separated
- Support JSON array format in files: `[5, 3, 1, 4, 2]`

### Output Formats
1. **sorted**: Just the sorted array
   ```
   [1, 2, 3, 4, 5]
   ```

2. **detailed**: Sorted array with statistics
   ```
   Input: [5, 3, 1, 4, 2]
   Output: [1, 2, 3, 4, 5]
   Comparisons: 10
   Swaps: 4
   ```

3. **steps**: Show each pass
   ```
   Pass 1: [3, 1, 4, 2, 5]
   Pass 2: [1, 3, 2, 4, 5]
   Pass 3: [1, 2, 3, 4, 5]
   ...
   Final: [1, 2, 3, 4, 5]
   ```

### Error Handling
- Invalid numbers: "Error: Invalid number 'abc' at position 2"
- File not found: "Error: File 'data.txt' not found"
- Empty input: "Error: No input provided"
- Invalid file format: "Error: Invalid JSON format"

### Testing Standards
- Test file location: `tests/test_cli.py`
- Use pytest with pytest-cov
- Mock file I/O operations in tests
- Test all command-line options and formats
- Include integration tests that test the full CLI pipeline

### Dependencies
- **Prerequisites**:
  - Story 1.1 (Project Setup and Infrastructure)
  - Story 1.2 (Basic Bubble Sort Implementation)
- Story 1.3 (Comprehensive Testing Suite) can be used to validate CLI behavior

### Notes
- The CLI should leverage the existing bubble_sort() function from Story 1.2
- Focus on user-friendliness and educational value
- Provide clear output that helps users understand the algorithm
- The CLI should be suitable for both quick testing and educational demonstrations
- This completes the Epic 1 implementation

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-06 | 1.0 | Initial story creation from Epic 1 | Scrum Master |
| 2026-01-07 | 1.1 | Implementation complete, all tests passing | Dev Agent (James) |

## Dev Agent Record

### Agent Model Used
Claude 3.5 Sonnet (claude-sonnet-4-20250514)

### Debug Log References
None - implementation completed without issues

### Completion Notes List
- Created `src/cli.py` with full CLI implementation using argparse
- Created `src/__main__.py` for module execution support (`python -m src`)
- Updated `src/__init__.py` with exports for CLI functions
- Updated `pyproject.toml` with `bubble-sort` entry point
- Created comprehensive test suite `tests/test_cli.py` with 87 tests covering:
  - Input parsing (space-separated, comma-separated, JSON arrays)
  - File input (JSON, text, stdin)
  - Output formats (sorted, detailed, steps)
  - Interactive mode
  - Error handling
  - Edge cases
- All 328 bubble sort and CLI tests pass

### File List
- `src/cli.py` (new) - CLI implementation with argparse
- `src/__main__.py` (new) - Module entry point
- `src/__init__.py` (modified) - Added CLI exports
- `pyproject.toml` (modified) - Added bubble-sort script entry point
- `tests/test_cli.py` (new) - Comprehensive test suite (87 tests)

## QA Results
(none - populated during QA review)
