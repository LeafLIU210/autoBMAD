# Story 1.4: Command-Line Interface

**Status:** Ready for Review
**Epic:** Epic 1: Core Algorithm Foundation

## User Story
**As a user,**
I want a command-line interface to test the bubble sort algorithm,
so that I can easily demonstrate and experiment with the implementation.

## Acceptance Criteria

1. Create CLI entry point that accepts arrays as command-line arguments
2. Support reading arrays from files or standard input
3. Provide options for different output formats (sorted array, detailed process)
4. Include help documentation and usage examples
5. Handle command-line errors gracefully with helpful error messages
6. Support both interactive and batch modes of operation

## Tasks/Subtasks

- [x] Create CLI module with entry point
- [x] Implement argument parsing (argparse or click)
- [x] Support command-line array input
- [x] Support file-based array input
- [x] Support standard input (pipe) input
- [x] Implement multiple output formats
- [x] Add comprehensive help documentation
- [x] Implement error handling and validation
- [x] Add interactive mode
- [x] Add batch mode
- [x] Create usage examples and documentation
- [x] Test all input/output modes

## Dev Notes

**CLI Design:**

**Command-line Arguments:**
```bash
python -m bubblesort --help
python -m bubblesort [1, 3, 2, 5, 4]
python -m bubblesort --file input.txt
cat input.txt | python -m bubblesort
python -m bubblesort --format detailed [3, 1, 2]
```

**Features:**
- Support comma-separated values: `[1,3,2]` or `1,3,2`
- Support space-separated values: `1 3 2`
- Support newline-separated values (from file/stdin)
- Output format options:
  - Default: sorted array only
  - `--format detailed`: show input, sorted output, and statistics
  - `--format steps`: show sorting steps (visualization)
  - `--format json`: JSON output format

**Error Handling:**
- Invalid input format
- Empty files
- Non-numeric values
- Mixed data types
- File not found errors

**Implementation Options:**
- Use `argparse` (standard library) - simpler
- Use `click` (third-party) - more features
- Recommendation: `argparse` for simplicity and no dependencies

**CLI Module Structure:**
```
src/bubblesort/
├── __init__.py
├── core.py (algorithm)
└── cli.py (CLI interface)
```

Entry point in `pyproject.toml`:
```toml
[project.scripts]
bubblesort = "bubblesort.cli:main"
```

## Testing

**Testing Strategy:**
- Unit tests for CLI functions
- Integration tests for command-line execution
- Test all input methods (CLI args, file, stdin)
- Test all output formats
- Test error handling
- Test help documentation

**Test Cases:**

**CLI Arguments:**
- [ ] Help message displays correctly
- [ ] Version information displays
- [ ] Single array argument works
- [ ] Multiple arrays fail gracefully
- [ ] Invalid format fails gracefully

**File Input:**
- [ ] Read from file successfully
- [ ] File not found error handled
- [ ] Empty file handled
- [ ] Invalid format in file handled

**Standard Input:**
- [ ] Pipe input works
- [ ] Redirect input works
- [ ] Empty stdin handled

**Output Formats:**
- [ ] Default format outputs sorted array
- [ ] Detailed format shows input and statistics
- [ ] Steps format shows sorting process
- [ ] JSON format valid JSON output

**Error Handling:**
- [ ] Invalid input format
- [ ] Non-numeric values
- [ ] Mixed data types
- [ ] Empty input

**Test Implementation:**
```python
from click.testing import CliRunner
from bubblesort.cli import main

runner = CliRunner()

def test_basic_sort():
    result = runner.invoke(main, ['[3,1,2]'])
    assert result.exit_code == 0
    assert '[1, 2, 3]' in result.output

def test_file_input(tmp_path):
    file_path = tmp_path / "input.txt"
    file_path.write_text("3,1,2")
    result = runner.invoke(main, ['--file', str(file_path)])
    assert result.exit_code == 0
```

## Definition of Done

- [ ] All acceptance criteria met
- [ ] CLI accepts array arguments
- [ ] File input support working
- [ ] Standard input support working
- [ ] Multiple output formats implemented
- [ ] Help documentation complete
- [ ] Error handling comprehensive
- [ ] Interactive mode working
- [ ] Batch mode working
- [ ] All tests passing
- [ ] Usage examples documented
- [ ] All tasks completed and checked off

## Additional Information

**Estimated Effort:** 2 days
**Dependencies:** Story 1.2 (Basic Bubble Sort Implementation)
**Priority:** Medium
**Risk Level:** Low

**Success Metrics:**
- CLI functionality: 100%
- Input methods: All working
- Output formats: All working
- Error handling: Comprehensive
- Documentation: Complete

**Tools and Libraries:**
- argparse (standard library) or click
- pytest for testing
- CliRunner for testing (if click)

**User Experience:**
- Clear, helpful error messages
- Intuitive command-line interface
- Comprehensive help documentation
- Multiple ways to provide input
- Multiple output format options

**Examples:**

Basic usage:
```bash
$ bubblesort [5, 3, 8, 1]
[1, 3, 5, 8]
```

Detailed output:
```bash
$ bubblesort --format detailed [5, 3, 8, 1]
Input: [5, 3, 8, 1]
Sorted: [1, 3, 5, 8]
Comparisons: 10
Swaps: 6
```

File input:
```bash
$ bubblesort --file numbers.txt
[1, 2, 3, 4, 5]
```
