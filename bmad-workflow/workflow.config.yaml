# BMAD Workflow Configuration
# This file contains configuration settings for the BMAD-Method PowerShell Workflow Automation

workflow:
  # Maximum number of QA iterations before giving up
  max_iterations: 10

  # Timeout for individual jobs in seconds (2 hours for interactive work)
  job_timeout_seconds: 7200

  # Number of concurrent development flows to run
  concurrent_dev_flows: 3

  # Enable workflow persistence
  enable_persistence: true

  # Enable automatic cleanup of completed jobs
  auto_cleanup: true

  # Delay between workflow phases in seconds (15 minutes per requirement)
  phase_delay_minutes: 15

claude:
  # Path to Claude Code CLI executable
  cli_path: "claude"

  # Skip permissions prompts (use with caution)
  skip_permissions: true

  # Delay between commands in seconds
  command_delay_seconds: 2

  # Maximum time to wait for Claude to initialize
  initialization_timeout_seconds: 30

  # Window style for Claude process (Normal, Hidden, Minimized, Maximized)
  window_style: "Normal"

  # Enable Claude Code hooks
  enable_hooks: true

process_management:
  # How often to poll job status in seconds
  polling_interval_seconds: 30  # 30s per user request (increased from 5s)

  # Maximum time to wait for all jobs in minutes
  max_wait_time_minutes: 120

  # Maximum number of concurrent jobs system-wide
  max_concurrent_jobs: 10

  # Graceful shutdown timeout in seconds
  shutdown_timeout_seconds: 30

  # Enable job priority management
  enable_priorities: false

logging:
  # Minimum log level: Debug, Info, Warning, Error, Critical
  level: "Info"

  # Base directory for log files
  base_log_directory: "./logs"

  # Workflow log directory
  workflow_log_directory: "./logs/workflow"

  # Debug log directory
  debug_log_directory: "./logs/debug"

  # Log rotation settings
  rotation:
    # Keep logs for this many days
    retention_days: 30

    # Compress logs older than this many days
    compress_after_days: 7

    # Maximum total log size in MB
    max_total_size_mb: 1000

  # Enable structured logging (JSON format)
  structured_logging: true

  # Enable console output
  console_output: true

error_handling:
  # Maximum number of retries for failed operations
  max_retries: 3

  # Exponential backoff base multiplier
  retry_backoff_multiplier: 2

  # Initial retry delay in seconds
  initial_retry_delay_seconds: 5

  # Enable circuit breaker pattern
  enable_circuit_breaker: false

  # Circuit breaker failure threshold
  circuit_breaker_threshold: 5

  # Circuit breaker reset timeout in seconds
  circuit_breaker_reset_timeout_seconds: 300

# NOTE: Monitoring configuration (monitoring:) section has been removed as of 2025-11-19
# The workflow now uses timer-based delays (15 minutes per phase) instead of process monitoring
# See workflow.phase_delay_minutes configuration above

security:
  # Enable process isolation
  enable_process_isolation: true

  # Working directory for isolated processes
  isolation_directory: "./temp"

  # Enable credential protection
  enable_credential_protection: true

  # Allowed file extensions for workflow operations
  allowed_file_extensions:
    - ".md"
    - ".txt"
    - ".yaml"
    - ".yml"
    - ".json"
    - ".ps1"
    - ".py"
    - ".js"
    - ".ts"

  # Blocked file patterns
  blocked_file_patterns:
    - "*.exe"
    - "*.bat"
    - "*.cmd"
    - "*.scr"
    - "*.dll"

notifications:
  # Enable workflow completion notifications
  enable_completion_notifications: true

  # Enable error notifications
  enable_error_notifications: true

  # Notification methods: console, email, webhook
  notification_methods:
    - "console"

  # Email configuration (if email notifications enabled)
  email:
    smtp_server: ""
    smtp_port: 587
    username: ""
    password: ""
    from_address: ""
    to_addresses: []

  # Webhook configuration (if webhook notifications enabled)
  webhook:
    url: ""
    headers: {}
    timeout_seconds: 30

hooks:
  # Enable automatic hook registration
  auto_register: true

  # Hook script directory
  script_directory: "./hooks"

  # Hook configuration file
  config_file: "./config/claude.hooks.json"

  # Enable hook execution timeout
  enable_timeout: true

  # Hook execution timeout in seconds
  timeout_seconds: 30

development:
  # Enable debug mode
  debug_mode: true

  # Enable mock mode for testing
  mock_mode: false

  # Mock execution time range in seconds (min, max)
  mock_execution_time_range:
    min: 10
    max: 30

  # Enable verbose output
  verbose_output: false

  # Enable dry run mode
  dry_run: false

  # Enable step-by-step confirmation
  step_by_step: false

# Environment-specific overrides
environments:
  development:
    logging:
      level: "Debug"
    workflow:
      max_iterations: 3
    development:
      debug_mode: true
      verbose_output: true

  testing:
    workflow:
      max_iterations: 2
      job_timeout_seconds: 600
    development:
      mock_mode: true
    logging:
      level: "Warning"

  production:
    logging:
      level: "Info"
      console_output: false
    workflow:
      max_iterations: 15
      job_timeout_seconds: 7200
    monitoring:
      enable_performance_monitoring: true
      enable_health_checks: true
    security:
      enable_process_isolation: true
      enable_credential_protection: true

# Version information
version:
  major: 1
  minor: 0
  patch: 0
  build: "2025.11.14"