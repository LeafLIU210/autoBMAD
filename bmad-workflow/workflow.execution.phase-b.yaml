# BMAD Workflow Execution Configuration - Phase B
# QA Review: Single QA Agent
# ✅ FIXES: QA agent receives *review instead of *develop-story

schema: 2
phase: b
phase_name: "Phase B - QA Review & Gate Decision"
clock_source: "system_timer"               # Timer-based, not process monitoring

deployment:
  agent_type: "qa"
  instance_count: 1                        # Single QA agent
  command: "*review"                       # ✅ CORRECT: QA review command
  mode: "single"
  staggered_start: false

behavior:
  autoExecute: true
  autoExecuteCommand: "*review"           # ✅ CRITICAL FIX: QA-specific command
  showHelp: false                          # Quiet mode
  timeout: 2700                            # 45 minutes (QA typically faster)
  exitOnComplete: false                    # Wait for timer

timer_integration:
  phase_delay_minutes: 30
  wait_for_timer: true
  exit_behavior: "evaluate_qa_result"      # Workflow checks QA gate decision

logging:
  log_level: "Info"
  capture_output: true
  log_file_prefix: "phase-b"
  console_output: true

# Agent-specific settings
agent_config:
  skip_permissions: true
  dangerously_skip_permissions: true
  command_delay_seconds: 1

# QA-specific settings
qa_gate:
  create_gate_file: true
  gate_location: "docs/qa/gates"
  gate_template: ".bmad-core/templates/qa-gate-tmpl.yaml"
  decision_keys: ["PASS", "CONCERNS", "FAIL", "WAIVED"]

# Transition settings (workflow evaluates QA result)
transition:
  decision_point: true                     # Workflow evaluates QA gate
  next_phase_pass: "d"                     # QA PASS → Phase D
  next_phase_concerns: "c"                 # QA CONCERNS → Phase C
  next_phase_fail: "c"                     # QA FAIL → Phase C
  transition_type: "decision_based"
